<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <!-- <title>D3 Test</title> -->
        <link href="styles.css" rel="stylesheet">
        <script src="https://d3js.org/d3.v5.min.js"></script>
    </head>
    <body>
        <script type="text/javascript">
            // Your beautiful D3 code will go here
            d3.select("head")
              .append("title")
              .text("Labour participation Netherlands");

            d3.select("body")
              .style("font-size", "25px")
              .style("font-weight", "bold")
              .text("Labour participation NL per province");

            d3.select("body")
              .append("p")
              .style("font-size", "15px")
              .style("font-weight", "normal")
              .text("Name: Julien Fer");

            d3.select("body")
              .append("p")
              .style("font-size", "15px")
              .style("font-weight", "normal")
              .text("Studentnumber: 10649441");

            d3.select("body")
              .append("p")
              .style("font-size", "15px")
              .style("font-weight", "normal")
              .text("The bar chart visualizes the unemployment rate in the netherlands per province (2018)")

            var file = "arbeidsdeelname.json";
            const WIDTH = 500;
            const HEIGHT = 500;
            var year = "2018";
            var barPadding = 1;
            var provinces = [];
            var data = [];
            var counter = 0;

            // read local JSON file
            d3.json(file).then(function(dataset) {
              provinces = Object.keys(dataset);

              provinces.forEach( function(province) {
                data.push(dataset[province][year]);
              })

              console.log(data);
              console.log(provinces);

              var svg = d3.select("body")
                          .append("svg")
                          .attr("width", WIDTH)
                          .attr("height", HEIGHT);

              console.log(data);
              svg.selectAll("rect")
                 .data(data)
                 .enter()
                 .append("rect")
                 .attr("class", "bar")
                 .attr("id", function(d, i) {
                   return provinces[i];
                 })
                 .attr("x", function(d, j) {
                      return j * (WIDTH / data.length);
                  })
                  .attr("y", function(d) {
                       return HEIGHT - d * 75;  //Height minus data value
                   })
                 .attr("width", WIDTH / data.length - barPadding)
                 .attr("height", function(d) {
                      return d * 75;  // <-- Times four!
                  });


                svg.selectAll("text")
                   .data(data)
                   .enter()
                   .append("text")
                   .attr("class", "labels")
                   .text(function(d) {
                     return d;
                   })
                   .attr("x", function(d, i) {
                     return i * (WIDTH / data.length) + (WIDTH / data.length * 0.5 - barPadding);
                   })
                   .attr("y", function(d) {
                     return HEIGHT - d * 75 + 14;
                   })
              });




        </script>
    </body>
</html>
